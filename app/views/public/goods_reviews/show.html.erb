<div class="row mt-4 pb-4 border-bottom">
  <h2 class="text-center">グッズレビュー詳細</h2>
</div>

<div class="row mt-5 justify-content-center border-bottom">
  <div class="col-6 pb-5">
    <table class="table table-borderless">
      <tr>
        <th>タイトル</th>
        <td>
          <%= @goods_review.goods_name %>
        </td>
      </tr>

      <tr>
        <th>概要</th>
        <td>
          <%= @goods_review.goods_summary %>
        </td>
      </tr>

      <tr>
        <th>タグ</th>
        <td>
          <% @goods_tags.each do |goods_tag| %>
            <%= goods_tag.goods_tag_name %>
          <% end %>
        </td>
      </tr>

      <tr>
        <th>感想</th>
        <td>
          <%= @goods_review.goods_impression %>
        </td>
      </tr>

      <tr>
        <th>￥</th>
        <td>
          <%= @goods_review.goods_price.to_s(:delimited) %>
        </td>
      </tr>

      <tr>
        <th>評価</th>
        <td>
          <div id="review_display<%= @goods_review.id %>">
          </div>
          <%= render "review_display", goods_review: @goods_review %>
        </td>
      </tr>
    </table>

    <div class="row d-flex justify-content-evenly">
      <div class="col-2 mt-4 text-center">
        <% if @goods_review.goods_likes?(current_member) %>
          <%= link_to goods_review_goods_like_path(@goods_review.id), method: :delete do %>
            <i class="fa-solid fa-heart fa-3x"></i>
          <% end %>
        <% else %>
          <%= link_to goods_review_goods_likes_path(@goods_review.id), method: :post do %>
            <i class="fa-regular fa-heart fa-3x"></i>
          <% end %>
        <% end %>
      </div>

      <button class="actions col-2 mt-4 btn btn btn-danger btn-lg">
        <%= link_to "削除", goods_review_path(@goods_review), method: :delete, class:"text-light" %>
      </button>
    </div>
  </div>
</div>

<div class="row mt-5 justify-content-center">
  <div class="col-7 pb-5 border-bottom">
    <% unless @goods_comment.id.nil? %>
      <%= form_with model: @goods_comment, url: goods_review_goods_comment_path(@goods_comment, goods_review_id: @goods_review) do |f| %>
        <div class="input-group d-flex justify-content-center">
          <div class="col-10 text-wrap">
            <%= f.text_field :goods_comment, placeholder: "コメントを送信", class:"form-control form-control-sm" %>
          </div>

          <div>
            <%= button_tag method: :patch do %>
              <i class="fa-solid fa-square-caret-down"></i>
            <% end %>
          </div>
        </div>

        <div class="col-3 offset-1">
          <%= link_to "キャンセル", goods_review_path(@goods_review), class:"link-dark" %>
        </div>
      <% end %>
    <% else %>
      <%= form_with model: @goods_comment, url: goods_review_goods_comments_path(goods_review_id: @goods_review) do |f| %>
        <div class="input-group d-flex justify-content-center">
          <div class="col-10 text-wrap">
            <%= f.text_field :goods_comment, placeholder: "コメントを送信", class:"form-control form-control-sm" %>
          </div>

          <div>
            <%= button_tag method: :post do %>
              <i class="fa-solid fa-square-caret-down"></i>
            <% end %>
          </div>
        </div>
      <% end %>
    <% end %>
    <table class="mt-3 table table-borderless">
      <% @goods_comments.each do |goods_comment| %>
        <tr>
          <td><%= image_tag goods_comment.member.get_profile_image(50, 50) %></td>

          <td class="text-break">
            <%= goods_comment.member.member_name %><br>
            <%= goods_comment.goods_comment %>
          </td>

          <td>
            <div class="dropend">
              <button class="btn btn-primary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
              </button>

              <ul class="dropdown-menu">
                <li class="text-center">
                  <a class="dropdown-item">
                    <%= link_to "編集", goods_review_path(@goods_review, goods_comment_id: goods_comment), class:"link-dark" %>
                  </a>
                </li>

                <li class="text-center">
                  <a class="dropdown-item">
                    <%= link_to "削除", goods_review_goods_comment_path(@goods_review, goods_comment), method: :delete, class:"link-dark" %>
                  </a>
                </li>
              </ul>
            </div>
          </td>
        </tr>
      <% end %>
    </table>
  </div>
</div>